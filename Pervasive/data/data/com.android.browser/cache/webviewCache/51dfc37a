function CRequestMgr(){var c={Other:0,PaginateNext:1,PaginatePrev:2};window.RequestType=c;var b={Success:0,Failure:1,FailureHip:2};window.PartialResponseStatus=b;var e=function(e,f,a,d,b){this.action=e;this.verb=f;this.callback=a;this.payload=d;this.context=b;this.errorCallback=null;this.queueCallback=null;this.requestType=c.Other;this.dispose=function(){this.action=this.verb=this.callback=this.payload=this.context=this.errorCallback=this.queueCallback=null}};window.RequestInfo=e;var f=function(){this._queue=[];this.dispose=function(){this._queue=null};this.getLength=function(){return this._queue.length};this.enqueue=function(a){this._queue.push(a)};this.dequeue=function(){if(this._queue.length>0)return this._queue.shift();else throw"Queue is empty";}};window.Queue=f;var a=this;a._queue=new Queue;a.acceptsRequests=true;a._serviceBaseUrl="/m/";a._pendingRequest=false;a.go=function(a){window.location.href=a};a.enqueueRequest=function(b){if(a.acceptsRequests){a._queue.enqueue(b);a._processQueue()}};a.addToPayload=function(a){if(a.length>0&&a.substr(a.length-1)!="&")a=a+"&";for(var b=1;b<arguments.length;b+=2){a=a+arguments[b]+"="+arguments[b+1];if(b<arguments.length-2)a=a+"&"}return a};a.appendToPayload=function(a,b){if(a&&a!="")a+="&"+b;else a=b;return a};a.addToQuery=function(a){a=a+(a.indexOf("?")<0?"?":"&");for(var b=1;b<arguments.length;b+=2){a=a+arguments[b]+"="+arguments[b+1];if(b<arguments.length-2)a=a+"&"}return a};a.getUrl=function(c,d,b){return a._serviceBaseUrl+c+(b?".mp/":".m/")+d};a._processQueue=function(){if(a._queue.getLength()>0&&!a._pendingRequest){var b=a._queue.dequeue();if(window.ActionBarMgr)ActionBarMgr.startAsync();if(b.queueCallback){b=b.queueCallback(b);if(!b)throw"Request returned by queueCallback cannot be null";}var d={},c;if(b.verb=="POST"){c=a.addToPayload(b.payload,"mt",a._mt);d["Content-Type"]="application/x-www-form-urlencoded"}else c="";a._pendingRequest=true;$Network.fetchXML(b.action,a._onResponse,b.verb,c,d,b)}};a._onResponse=function(c,e){if(window.ActionBarMgr)ActionBarMgr.completeAsync();if(c&&c.readyState==4&&c.status==200){var f=new d(c,e);if(f.status==b.Success){if(e.callback)e.callback.apply(null,f.args)}else a._handleError(e,c,f.status,f.args[0])}else if(!c||c.readyState!=4||c.status!==0)a._handleError(e,c,b.Failure);a._pendingRequest=false;a._processQueue()};a._handleError=function(b,e,d,a){if(a&&a.indexOf("auth-expired:")==0){var c=a.substring("auth-expired:".length);if(c){FolderMgr.getRequest(c);return}}if(!b||!b.errorCallback||!b.errorCallback(d))if(window.NotifMgr)if(a)NotifMgr.showHtmlMessage({type:NotifType.Error,msg:a});else NotifMgr.showHtmlMessage({type:NotifType.Error,msg:StringMgr.reqErr});else throw"An error occurred during a request";};var d=function(g,f){var d=g.responseText,c=d.indexOf(";"),e=d.indexOf(";;");this.action=c>0?d.substring(0,c):"";this.isValid=c>=0&&e>=c&&this.action==f.action;if(!this.isValid){this.status=b.Failure;this.args=[];return}switch(d.substring(c+1,e)){case "Success":this.status=b.Success;break;case "FailureHip":this.status=b.FailureHip;break;case "Failure":default:this.status=b.Failure}this.args=a._deserializeArguments(d.substring(e+2));this.args.push(f.context)};a._deserializeArguments=function(a){if(a===null)return [];var b=a.indexOf(";;");if(b<0)return [];var e=a.substring(0,b).split(";"),g=[],h=a.substring(b+2),c=0;for(var d=0;d<e.length;d++){var f=parseInt(e[d],10);g.push(h.substring(c,c+f));c+=f+1}return g}}window.RequestMgr=window.RequestMgr||new CRequestMgr;window.NotifMgr=window.NotifMgr||{};(function(){var b={Error:0,Notification:1,StaticNotification:2};window.NotifType=b;var a=window.NotifMgr;a._initialized=false;a._showingMsgs=false;a.showCallback=null;a.close=function(){a._ensureInitialized();a._showingMsgs=false;for(var b=0;b<a._panels.length;b++)a._panels[b].style.display="none"};a.update=function(b){a._ensureInitialized();if(typeof b=="undefined")b=a.showCallback?a.showCallback():0;for(var c=0;c<a._panels.length;c++){var d=a._panels[c],e=a._showingMsgs&&(b===0||b-1==c);d.style.display=e?"block":"none"}};a.showMessage=function(c,b){a.showHtmlMessage(a.messages[c],b)};a.showHtmlMessage=function(e,k){a._ensureInitialized();a._showingMsgs=true;var d;if(e.type==b.Error)d="na_e";else d="na_n";var g=e.type!=b.StaticNotification,i="na_c "+d,h=StringMgr.imgBaseUrl+d+".gif";for(var c=0;c<a._panels.length;c++){var l=a._panels[c];$("pnl"+a._ids[c]).innerHTML=e.msg;l.className=i;var j=$("lnk"+a._ids[c]);j.innerHTML='<img src="'+h+'" onclick="NotifMgr.close(); return false;" alt="'+StringMgr.close+'" class="na_b"/>';var f=$("pnlLnk"+a._ids[c]);if(g)$css.remove(f,"hidden");else $css.add(f,"hidden")}a.update(k)};a.hasMessage=function(b){return a.messages[b]!==null};a._ensureInitialized=function(){if(!a._initialized){a._initialized=true;a._panels=[];if(a._ids)for(var b=0;b<a._ids.length;b++)a._panels.push($(a._ids[b]))}}})()